{"version":3,"sources":["assets\\src\\get47\\Get47Scene.ts"],"names":[],"mappings":";;;;;;AAAA,2CAA0C;AAE1C,mDAA8C;AAC9C,0BAAyB;AACzB,2CAAqC;AAE/B,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAgC,8BAAY;IAA5C;QAAA,qEA+EC;QA5EW,WAAK,GAAe,IAAI,CAAC;QAEzB,WAAK,GAAU,IAAI,CAAC;QAEpB,YAAM,GAAW,EAAE,CAAC;QAEpB,WAAK,GAAU,sBAAK,CAAC,IAAI,CAAC;;IAsEtC,CAAC;IApEG,0BAAK,GAAL;QACI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACtB,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,YAAY,EAAE,CAAC;IACxB,CAAC;IAEO,8BAAS,GAAjB;QACI,IAAI,CAAC,KAAK,GAAG,sBAAK,CAAC,KAAK,CAAC;QACzB,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;QACnB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACxB,CAAC;IAEO,6BAAQ,GAAhB;QACI,IAAI,CAAC,KAAK,GAAG,sBAAK,CAAC,IAAI,CAAC;QACxB,KAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,KAAK,EAC5B,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,EAAE,cAAQ,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC;IACvD,CAAC;IAEM,gCAAW,GAAlB,UAAmB,KAAa;QAC5B,IAAI,IAAI,CAAC,KAAK,KAAK,sBAAK,CAAC,KAAK,EAAE;YAC5B,OAAO;SACV;QACD,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;SACzB;aAAM,IAAI,KAAK,GAAG,CAAC,EAAE;YAClB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC;SAC5B;QACD,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,KAAK,IAAI,CAAC,MAAM,EAAE;YAChC,IAAI,CAAC,QAAQ,EAAE,CAAC;SACnB;IACL,CAAC;IAEM,iCAAY,GAAnB,UAAoB,KAAY,EAAE,GAAQ;QACtC,IAAI,IAAI,CAAC,KAAK,KAAK,sBAAK,CAAC,KAAK,EAAE;YAC5B,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;SACtC;IACL,CAAC;IAEO,gCAAW,GAAnB;QACI,KAAC,CAAC,UAAU,EAAE,CAAC;IACnB,CAAC;IAEO,iCAAY,GAApB;QACI,IAAI,CAAC,SAAS,EAAE,CAAC;IACrB,CAAC;IAEO,iCAAY,GAApB;QACI,0DAA0D;QAC1D,4FAA4F;IAChG,CAAC;IAEO,oCAAe,GAAvB;QACK,EAAU,CAAC,YAAY,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC;IAC5D,CAAC;IAEO,wCAAmB,GAA3B,UAA4B,KAAK;QAC7B,oEAAoE;QACpE,4BAA4B;QAC5B,IAAI;QACJ,UAAU;QACV,yBAAyB;QACzB,6BAA6B;QAC7B,IAAI;QACJ,2BAA2B;QAC3B,8BAA8B;QAC9B,IAAI;IACR,CAAC;IA1ED;QADC,QAAQ,CAAC,uBAAU,CAAC;6CACY;IAEjC;QADC,QAAQ,CAAC,kBAAK,CAAC;6CACY;IAE5B;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;8CACO;IAPnB,UAAU;QADtB,OAAO;OACK,UAAU,CA+EtB;IAAD,iBAAC;CA/ED,AA+EC,CA/E+B,EAAE,CAAC,SAAS,GA+E3C;AA/EY,gCAAU","file":"","sourceRoot":"/","sourcesContent":["import { Get47Board } from \"./Get47Board\";\nimport { Piece } from \"./Get47Piece\";\nimport { DIR, STATE } from \"./Get47Constants\";\nimport { G } from \"../G\";\nimport { Score } from \"./Get47Score\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport class Get47Scene extends cc.Component {\n\n    @property(Get47Board)\n    private board: Get47Board = null;\n    @property(Score)\n    private score: Score = null;\n    @property(cc.Integer)\n    private target: number = 47;\n\n    private state: STATE = STATE.NONE;\n\n    start() {\n        this.board.init(this);\n        this.startGame();\n        this.addListeners();\n    }\n\n    private startGame() {\n        this.state = STATE.START;\n        this.board.reset();\n        this.score.reset(0);\n    }\n\n    private overGame() {\n        this.state = STATE.OVER;\n        G.gameRoot.showMaskMessage(\"666\",\n            { label: \"233\", cb: () => { }, target: this });\n    }\n\n    public updateScore(score: number) {\n        if (this.state !== STATE.START) {\n            return;\n        }\n        if (score > 0) {\n            this.score.add(score);\n        } else if (score < 0) {\n            this.score.minus(-score);\n        }\n        if (this.score.num === this.target) {\n            this.overGame();\n        }\n    }\n\n    public onPieceTouch(piece: Piece, dir: DIR) {\n        if (this.state === STATE.START) {\n            this.board.tryExchange(piece, dir);\n        }\n    }\n\n    private onBtnReturn() {\n        G.returnHall();\n    }\n\n    private onBtnRestart() {\n        this.startGame();\n    }\n\n    private addListeners() {\n        // (cc as any).inputManager.setAccelerometerEnabled(true);\n        // cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\n    }\n\n    private removeListeners() {\n        (cc as any).inputManager.setAccelerometerEnabled(false);\n    }\n\n    private onDeviceMotionEvent(event) {\n        // if (Math.abs(event.acc.x) > 0.3 && Math.abs(event.acc.y) > 0.3) {\n        //     this.board.newView();\n        // }\n        // 一个失败的创意\n        // if(event.acc.x > 0.5){\n        //     this.board.newView(1);\n        // }\n        // if(event.acc.x < -0.5) {\n        //     this.board.newView(-1);\n        // }\n    }\n\n}\n"]}