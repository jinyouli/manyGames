{"version":3,"sources":["assets\\src\\mine\\MineScene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Piece } from \"./MinePiece\";\nimport { Board } from \"./MnieBoard\";\nimport { G } from \"../G\";\nimport { STATE } from \"./MineConstans\";\nimport { MineLevelLabel } from \"./MineLevelLabel\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport class MineScene extends cc.Component {\n\n    @property(Board)\n    private board: Board = null;\n    @property(cc.Label)\n    private bombNumLabel: cc.Label = null;\n    @property(cc.Label)\n    private flagNumLabel: cc.Label = null;\n    @property(MineLevelLabel)\n    private levelLabel: MineLevelLabel = null;\n\n    private state: STATE = STATE.NONE;\n    private level: number = 1;\n    private maxLevel: number = 20;\n\n    start() {\n        this.board.init(this);\n        this.maxLevel = this.board.getMaxLevel();\n        this.startGame(1);\n    }\n\n    startGame(level: number) {\n        this.level = level;\n        this.state = STATE.START;\n        this.board.reset(level);\n        this.levelLabel.level = level;\n        this.bombNumLabel.string = this.board.getBombNum() + \"\";\n        this.flagNumLabel.string = this.board.getFlagNum() + \"\";\n    }\n\n    overGame(isWin: boolean) {\n        this.state = STATE.OVER;\n        if (isWin) {\n            if (this.level === this.maxLevel) {\n                G.gameRoot.showMaskMessage(\"恭喜通关!\\n获得雷公称号!\",\n                    { label: \"233\", cb: () => { G.returnHall() }, target: this }\n                );\n            } else {\n                G.gameRoot.showMaskMessage(\"恭喜通过第\" + this.level + \"关!\",\n                    {\n                        label: \"下一关\", cb: () => {\n                            this.level++;\n                            this.startGame(this.level);\n                        }, target: this\n                    },\n                    { label: \"不玩了\", cb: () => { G.returnHall() }, target: this }\n                );\n            }\n        } else {\n            G.gameRoot.showMaskMessage(\"你死在了第\" + this.level + \"关!\",\n                {\n                    label: \"续命\", cb: () => {\n                        this.startGame(this.level);\n                    }, target: this\n                },\n                { label: \"不玩了\", cb: () => { G.returnHall() }, target: this }\n            );\n        }\n    }\n\n    onClickPiece(piece: Piece) {\n        if (this.state === STATE.START) {\n            this.board.openPiece(piece);\n            let bombNum = this.board.getBombNum();\n            this.bombNumLabel.string = bombNum + \"\";\n        }\n    }\n\n    onPressPiece(piece: Piece) {\n        if (this.state === STATE.START) {\n            this.board.flagPiece(piece);\n            let flagNum = this.board.getFlagNum();\n            this.flagNumLabel.string = flagNum + \"\";\n        }\n    }\n\n    onBtnReturn() {\n        G.returnHall();\n    }\n\n    onBtnRestart() {\n        this.startGame(this.level);\n    }\n}"]}